<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edu.dao.LectureMapper">

	<select id="getCheckedLecture" resultType="String">
		SELECT lecturenum
		FROM userlectureinfo
		WHERE userid = #{userid} AND coursenum = #{coursenum}  AND checkflag = 'Y' AND delflag = 'N'
	</select>

	<select id="getLastedLecture" resultType="com.edu.domain.Lecture">
		SELECT *
		FROM lecture
		WHERE lecno = (
			SELECT lecturenum
			FROM userlectureinfo
			WHERE userid = #{userid} AND coursenum = #{coursenum} AND checkflag = 'Y' AND delflag = 'N'
			ORDER BY lecturenum DESC
			LIMIT 1
		)
	</select>

    <select id="getLectureInfo" resultType="com.edu.domain.UserLectureInfo">
		SELECT *
		FROM userlectureinfo
		WHERE userid = #{userid} AND coursenum = #{coursenum} AND lecturenum = #{lecturenum} AND delflag = 'N'

	</select>

    <insert id="insertLectureInfo">
        INSERT INTO userlectureinfo (userid, coursenum, lecturenum, checkflag) VALUES (#{userid}, #{coursenum}, #{lecturenum} , #{checkflag})
    </insert>

    <update id="updateLectureInfo" >
        UPDATE userlectureinfo
        SET
          checkflag = #{checkflag}
        WHERE userid = #{userid} AND coursenum = #{coursenum} AND lecturenum = #{lecturenum} AND delflag = 'N'

    </update>

	
</mapper>